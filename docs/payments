# üîó Production Webhook URLs

Quick reference for webhook URLs now that `https://www.parlaygorilla.com` is live.

---

## ‚úÖ Production Webhook URLs

### Stripe Webhook
```
https://api.parlaygorilla.com/api/webhooks/stripe
```

**Where to configure:**
1. Go to [Stripe Dashboard](https://dashboard.stripe.com/webhooks)
2. Click "Add endpoint"
3. Enter webhook URL: `https://api.parlaygorilla.com/api/webhooks/stripe`
4. Select events:
   - ‚úÖ `checkout.session.completed`
   - ‚úÖ `customer.subscription.created`
   - ‚úÖ `customer.subscription.updated`
   - ‚úÖ `customer.subscription.deleted`
   - ‚úÖ `invoice.paid`
   - ‚úÖ `invoice.payment_failed`
5. Copy the webhook signing secret and add to backend environment: `STRIPE_WEBHOOK_SECRET`

---

### LemonSqueezy Webhook (DEPRECATED)
```
https://api.parlaygorilla.com/api/webhooks/lemonsqueezy
```

**Status:** Deprecated. Migrated to Stripe. This endpoint is kept for backward compatibility during migration but should not be used for new subscriptions.

---

## üîê Environment Variables

**YES - These MUST be set in Render's environment variables for production!**

The `.env` file is only for local development. In production on Render, you need to add these manually:

### How to Add to Render:

1. **Go to Render Dashboard**: https://dashboard.render.com
2. **Click on `parlay-gorilla-backend` service**
3. **Go to "Environment" tab**
4. **Click "Add Environment Variable"**
5. **Add these two variables:**

```env
# Stripe Webhook Secret
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_from_stripe

# Stripe API Key
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key

# Stripe Price IDs
STRIPE_PRICE_ID_PRO_MONTHLY=price_...
STRIPE_PRICE_ID_PRO_ANNUAL=price_...
```

6. **Click "Save Changes"** - Render will automatically redeploy

**Important Notes:**
- These are secrets - never commit them to git
- Get the secrets from each payment provider's dashboard after creating the webhook
- Render will redeploy automatically after you save
- The webhook endpoints won't work without these secrets (signature verification will fail)

---

## ‚úÖ Verification Checklist

- [ ] Stripe webhook URL configured: `https://api.parlaygorilla.com/api/webhooks/stripe`
- [ ] Stripe webhook secret (`STRIPE_WEBHOOK_SECRET`) added to backend environment
- [ ] Stripe API key (`STRIPE_SECRET_KEY`) added to backend environment
- [ ] Stripe Price IDs configured for monthly and annual plans
- [ ] Backend restarted/redeployed after adding secrets
- [ ] Test webhook delivery (create test subscription and verify webhook is received)

---

## üß™ Testing

After configuring webhooks:

1. **Stripe**: Create a test subscription and check:
   - Stripe Dashboard ‚Üí Webhooks ‚Üí Your webhook ‚Üí Recent deliveries (should show 200 OK)
   - Backend logs should show: `"Processed Stripe webhook event: customer.subscription.created"`
   - Use Stripe CLI for local testing: `stripe listen --forward-to localhost:8000/api/webhooks/stripe`

---

## üìö Full Documentation

- [Stripe Webhook Setup Guide](./STRIPE_WEBHOOK_SETUP.md) - Detailed setup instructions

---

**Last Updated:** Production domain is live at `https://www.parlaygorilla.com` with backend at `https://api.parlaygorilla.com`

