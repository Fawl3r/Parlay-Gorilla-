# üöÄ Deploy to Render NOW - Step-by-Step Guide

This guide will get your site live on Render **today** so you can sign up for LemonSqueezy.

## ‚ö° Quick Start (5 Steps)

### Step 1: Push Your Code to GitHub

```bash
# Make sure all changes are committed
git add .
git commit -m "Ready for Render deployment"
git push origin main
```

**Verify:** Your code is on GitHub and the repo is accessible.

---

### Step 2: Deploy via Render Blueprint

1. **Go to Render Dashboard**: https://dashboard.render.com
2. **Click "New +"** ‚Üí **"Blueprint"**
3. **Connect GitHub**:
   - Click "Connect GitHub" if not already connected
   - Authorize Render to access your repos
   - Select your `F3 Parlay Gorilla` repository
4. **Render will detect `render.yaml`** and show you a preview of what will be created:
   - ‚úÖ `parlay-gorilla-postgres` (PostgreSQL database)
   - ‚úÖ `parlay-gorilla-redis` (Redis/Key Value store)
   - ‚úÖ `parlay-gorilla-backend` (FastAPI backend)
   - ‚úÖ `parlay-gorilla-frontend` (Next.js frontend)
   - ‚úÖ `parlay-gorilla-inscriptions-worker` (optional worker)
5. **Click "Apply"** to create everything

**‚è±Ô∏è This takes 5-10 minutes.** Render will:
- Create the database
- Create Redis
- Build and deploy backend
- Build and deploy frontend

---

### Step 3: Set Environment Variables (Backend)

Once the backend service is created, go to **Environment** tab and add:

#### Required Variables (Copy from your `.env` file):

```
THE_ODDS_API_KEY=your_odds_api_key_here
THE_ODDS_API_FALLBACK_KEY=your_fallback_key_here
OPENAI_API_KEY=your_openai_api_key_here
```

#### URL Variables (Use Render's default URLs for now):

**First, check your backend service URL:**
- Go to `parlay-gorilla-backend` service
- Look at the top - it will be something like: `https://parlay-gorilla-backend.onrender.com`
- Copy that URL

**Then set these (replace with YOUR actual URLs):**

```
FRONTEND_URL=https://parlay-gorilla-frontend.onrender.com
BACKEND_URL=https://parlay-gorilla-backend.onrender.com
APP_URL=https://parlay-gorilla-frontend.onrender.com
```

#### Optional (But Recommended):

```
RESEND_API_KEY=re_your_api_key_here
RESEND_FROM="Parlay Gorilla <onboarding@resend.dev>"  # or your verified domain sender
SPORTSRADAR_API_KEY=your_key_here
OPENWEATHER_API_KEY=your_key_here
PEXELS_API_KEY=your_key_here
```

**‚úÖ Auto-Wired (Don't Set These):**
- `DATABASE_URL` - Auto-wired from PostgreSQL
- `REDIS_URL` - Auto-wired from Redis
- `JWT_SECRET` - Auto-generated by Render
- `ENVIRONMENT` - Set to `production`
- `DEBUG` - Set to `false`

---

### Step 4: Set Environment Variables (Frontend)

Go to `parlay-gorilla-frontend` service ‚Üí **Environment** tab:

**Set this (use YOUR frontend URL):**

```
NEXT_PUBLIC_SITE_URL=https://parlay-gorilla-frontend.onrender.com
```

**‚úÖ Auto-Wired (Don't Set These):**
- `PG_BACKEND_URL` - Auto-wired from backend service (private network)
- `NEXT_PUBLIC_API_URL` - Set in render.yaml

---

### Step 5: Wait for Deployments & Test

1. **Wait for all services to show "Live"** (green status)
2. **Test your frontend**: Visit `https://parlay-gorilla-frontend.onrender.com`
3. **Test health check**: Visit `https://parlay-gorilla-frontend.onrender.com/health`
4. **Test registration**: Try signing up at `/auth/signup`

---

## üéØ What You'll Have After This

‚úÖ **Live website**: `https://parlay-gorilla-frontend.onrender.com`  
‚úÖ **Live API**: `https://parlay-gorilla-backend.onrender.com`  
‚úÖ **Working database**: PostgreSQL (managed by Render)  
‚úÖ **Working Redis**: For caching and jobs  

**You can now use these URLs to sign up for LemonSqueezy!**

---

## üîß Troubleshooting

### Backend won't start?

1. **Check logs**: Go to backend service ‚Üí **Logs** tab
2. **Common issues**:
   - Missing `THE_ODDS_API_KEY` ‚Üí Add it in Environment
   - Missing `OPENAI_API_KEY` ‚Üí Add it or set `OPENAI_ENABLED=false`
   - Database connection error ‚Üí Wait 2-3 minutes for DB to finish provisioning

### Frontend won't build?

1. **Check logs**: Go to frontend service ‚Üí **Logs** tab
2. **Common issues**:
   - Build timeout ‚Üí Upgrade to `starter` plan (free plan has limits)
   - Missing env vars ‚Üí Check that `NEXT_PUBLIC_SITE_URL` is set

### Database migration needed?

The backend will auto-create tables on first startup. If you see migration errors:

1. Go to backend service ‚Üí **Shell** tab
2. Run: `alembic upgrade head`

---

## üìù Next Steps (After Deployment)

### 1. Sign Up for LemonSqueezy

Now that you have a live site:
1. Go to https://lemonsqueezy.com
2. Sign up for an account
3. Create a store
4. Get your API keys
5. Add them to Render backend environment variables

### 2. Set Up Custom Domain (Optional)

If you have a domain:
1. Go to Cloudflare (or your DNS provider)
2. Add CNAME records:
   - `www` ‚Üí `parlay-gorilla-frontend.onrender.com`
   - `api` ‚Üí `parlay-gorilla-backend.onrender.com`
3. In Render, go to each service ‚Üí **Settings** ‚Üí **Custom Domains**
4. Add your domain
5. Update environment variables with your custom domain URLs

### 3. Enable Web Push (Optional)

If you want push notifications:
1. Generate VAPID keys: `npx web-push generate-vapid-keys`
2. Add to backend environment:
   - `WEB_PUSH_ENABLED=true`
   - `WEB_PUSH_VAPID_PUBLIC_KEY=...`
   - `WEB_PUSH_VAPID_PRIVATE_KEY=...`

---

## üí∞ Cost Estimate

**Free Tier (Good for Testing):**
- Frontend: Free (may spin down)
- Backend: Free (may spin down)
- Database: Free (expires after 90 days)
- Redis: Free
- **Total: $0/month**

**Starter Tier (Recommended for Production):**
- Frontend: $7/month (always-on)
- Backend: $7/month (always-on)
- Database: $7/month (persistent)
- Redis: Free
- **Total: ~$21/month**

---

## ‚úÖ Deployment Checklist

- [ ] Code pushed to GitHub
- [ ] Render Blueprint deployed
- [ ] Backend environment variables set
- [ ] Frontend environment variables set
- [ ] All services showing "Live"
- [ ] Frontend loads at Render URL
- [ ] Health check works (`/health`)
- [ ] Can register a new user
- [ ] Can generate a parlay

**Once all checked, you're ready to sign up for LemonSqueezy!** üéâ

